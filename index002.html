<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒ± NhÃ  nÃ´ng thÃ´ng thÃ¡i - Lá»›p há»c xanh</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(160deg, #a5d6a7, #c8e6c9);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    #game {
      background: #fff;
      width: 90%;
      max-width: 600px;
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
      text-align: center;
    }
    h1 { color: #2e7d32; }
    button {
      background-color: #4caf50;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      margin-top: 15px;
      cursor: pointer;
      font-size: 16px;
      transition: 0.3s;
    }
    button:hover { background-color: #388e3c; transform: scale(1.05); }
    .hidden { display: none; }
    .question { font-size: 18px; margin-bottom: 10px; }
    .answers button {
      display: block;
      width: 100%;
      margin: 6px 0;
      background-color: #81c784;
      font-weight: 500;
    }
    .answers button.correct { background-color: #66bb6a; }
    .answers button.wrong { background-color: #ef5350; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
    }
    th { background: #a5d6a7; }
  </style>
</head>
<body>
  <div id="game">
    <h1>ğŸŒ¿ NhÃ  nÃ´ng thÃ´ng thÃ¡i ğŸŒ¾</h1>

    <div id="login-screen">
      <p>Nháº­p tÃªn cá»§a báº¡n Ä‘á»ƒ báº¯t Ä‘áº§u trÃ² chÆ¡i:</p>
      <input type="text" id="playerName" placeholder="TÃªn há»c sinh">
      <button id="start-btn">Báº¯t Ä‘áº§u</button>
    </div>

    <div id="quiz-screen" class="hidden">
      <h2 id="question"></h2>
      <div id="answers" class="answers"></div>
      <button id="next-btn" class="hidden">CÃ¢u tiáº¿p theo â¡ï¸</button>
    </div>

    <div id="result-screen" class="hidden">
      <h2>ğŸ‰ Káº¿t quáº£ cá»§a báº¡n ğŸ‰</h2>
      <p id="score"></p>
      <button id="view-leaderboard-btn">Xem báº£ng xáº¿p háº¡ng ğŸ†</button>
      <button id="restart-btn">ChÆ¡i láº¡i ğŸ”</button>
    </div>

    <div id="leaderboard-screen" class="hidden">
      <h2>ğŸ† Báº£ng xáº¿p háº¡ng lá»›p há»c ğŸ†</h2>
      <table id="leaderboard-table">
        <tr><th>Háº¡ng</th><th>TÃªn</th><th>Äiá»ƒm</th></tr>
      </table>
      <button id="back-btn">â¬…ï¸ Quay láº¡i</button>
    </div>
  </div>

  <script>
    // Danh sÃ¡ch cÃ¢u há»i phong phÃº (chá»n ngáº«u nhiÃªn 5 cÃ¢u)
    const questionBank = [
      {q: "PhÃ¢n há»¯u cÆ¡ sinh há»c lÃ  gÃ¬?", a: [
        {t: "PhÃ¢n tá»« hÃ³a cháº¥t tá»•ng há»£p", c: false},
        {t: "PhÃ¢n lÃ m tá»« cháº¥t há»¯u cÆ¡ cÃ³ vi sinh váº­t cÃ³ Ã­ch", c: true},
        {t: "PhÃ¢n vÃ´ cÆ¡ cáº£i tiáº¿n", c: false}
      ]},
      {q: "Æ¯u Ä‘iá»ƒm cá»§a phÃ¢n há»¯u cÆ¡ sinh há»c lÃ  gÃ¬?", a: [
        {t: "GiÃºp cáº£i táº¡o Ä‘áº¥t, tÄƒng Ä‘á»™ phÃ¬, an toÃ n mÃ´i trÆ°á»ng", c: true},
        {t: "GÃ¢y Ã´ nhiá»…m Ä‘áº¥t vÃ  nÆ°á»›c", c: false},
        {t: "LÃ m cÃ¢y cháº¿t nhanh", c: false}
      ]},
      {q: "ThÃ nh pháº§n chÃ­nh cá»§a phÃ¢n há»¯u cÆ¡ sinh há»c lÃ :", a: [
        {t: "Cháº¥t há»¯u cÆ¡, vi sinh váº­t cÃ³ Ã­ch", c: true},
        {t: "Cháº¥t hÃ³a há»c, muá»‘i khoÃ¡ng", c: false},
        {t: "Kim loáº¡i náº·ng", c: false}
      ]},
      {q: "Khi nÃ o nÃªn bÃ³n phÃ¢n há»¯u cÆ¡ sinh há»c?", a: [
        {t: "Äáº§u vá»¥, khi cÃ¢y cÃ²n nhá»", c: true},
        {t: "Giá»¯a vá»¥", c: false},
        {t: "LÃºc thu hoáº¡ch", c: false}
      ]},
      {q: "NhÆ°á»£c Ä‘iá»ƒm cá»§a phÃ¢n há»¯u cÆ¡ sinh há»c lÃ  gÃ¬?", a: [
        {t: "KhÃ³ báº£o quáº£n, dinh dÆ°á»¡ng tháº¥p hÆ¡n phÃ¢n hÃ³a há»c", c: true},
        {t: "KhÃ´ng cÃ³ vi sinh váº­t", c: false},
        {t: "LÃ m Ä‘áº¥t chai cá»©ng", c: false}
      ]},
      {q: "PhÃ¢n há»¯u cÆ¡ sinh há»c giÃºp cÃ¢y nhÆ° tháº¿ nÃ o?", a: [
        {t: "GiÃºp cÃ¢y phÃ¡t triá»ƒn tá»± nhiÃªn, bá»n vá»¯ng", c: true},
        {t: "LÃ m giáº£m nÄƒng suáº¥t", c: false},
        {t: "KhÃ´ng áº£nh hÆ°á»Ÿng", c: false}
      ]},
      {q: "Vi sinh váº­t trong phÃ¢n há»¯u cÆ¡ cÃ³ vai trÃ² gÃ¬?", a: [
        {t: "PhÃ¢n giáº£i cháº¥t há»¯u cÆ¡, giÃºp cÃ¢y háº¥p thu dá»… hÆ¡n", c: true},
        {t: "GÃ¢y háº¡i cho cÃ¢y trá»“ng", c: false},
        {t: "KhÃ´ng áº£nh hÆ°á»Ÿng", c: false}
      ]},
      {q: "NguyÃªn liá»‡u nÃ o cÃ³ thá»ƒ dÃ¹ng lÃ m phÃ¢n há»¯u cÆ¡?", a: [
        {t: "Vá» rau cá»§, lÃ¡ cÃ¢y, rÆ¡m ráº¡", c: true},
        {t: "Nhá»±a, kim loáº¡i", c: false},
        {t: "Thá»§y tinh", c: false}
      ]}
    ];

    let playerName = "";
    let questions = [];
    let currentIndex = 0;
    let score = 0;

    const loginScreen = document.getElementById("login-screen");
    const quizScreen = document.getElementById("quiz-screen");
    const resultScreen = document.getElementById("result-screen");
    const leaderboardScreen = document.getElementById("leaderboard-screen");

    const questionEl = document.getElementById("question");
    const answersEl = document.getElementById("answers");
    const nextBtn = document.getElementById("next-btn");
    const scoreEl = document.getElementById("score");
    const leaderboardTable = document.getElementById("leaderboard-table");

    document.getElementById("start-btn").onclick = startGame;
    nextBtn.onclick = nextQuestion;
    document.getElementById("restart-btn").onclick = () => location.reload();
    document.getElementById("view-leaderboard-btn").onclick = showLeaderboard;
    document.getElementById("back-btn").onclick = () => {
      leaderboardScreen.classList.add("hidden");
      resultScreen.classList.remove("hidden");
    };

    function startGame() {
      const nameInput = document.getElementById("playerName").value.trim();
      if (!nameInput) return alert("Vui lÃ²ng nháº­p tÃªn trÆ°á»›c khi chÆ¡i!");
      playerName = nameInput;
      loginScreen.classList.add("hidden");
      quizScreen.classList.remove("hidden");
      questions = shuffle([...questionBank]).slice(0, 5);
      currentIndex = 0;
      score = 0;
      showQuestion();
    }

    function showQuestion() {
      nextBtn.classList.add("hidden");
      answersEl.innerHTML = "";
      const q = questions[currentIndex];
      questionEl.textContent = "CÃ¢u " + (currentIndex + 1) + ": " + q.q;
      q.a.forEach(ans => {
        const btn = document.createElement("button");
        btn.textContent = ans.t;
        btn.onclick = () => selectAnswer(btn, ans.c);
        answersEl.appendChild(btn);
      });
    }

    function selectAnswer(btn, correct) {
      const buttons = answersEl.querySelectorAll("button");
      buttons.forEach(b => b.disabled = true);
      if (correct) {
        btn.classList.add("correct");
        score++;
      } else {
        btn.classList.add("wrong");
      }
      nextBtn.classList.remove("hidden");
    }

    function nextQuestion() {
      currentIndex++;
      if (currentIndex < questions.length) showQuestion();
      else showResult();
    }

    function showResult() {
      quizScreen.classList.add("hidden");
      resultScreen.classList.remove("hidden");
      scoreEl.textContent = `Äiá»ƒm cá»§a ${playerName}: ${score}/${questions.length}`;
      saveToLeaderboard();
    }

    // LÆ°u báº£ng xáº¿p háº¡ng vÃ o localStorage
    function saveToLeaderboard() {
      let leaderboard = JSON.parse(localStorage.getItem("compost_leaderboard") || "[]");
      leaderboard.push({name: playerName, score});
      leaderboard.sort((a, b) => b.score - a.score);
      localStorage.setItem("compost_leaderboard", JSON.stringify(leaderboard));
    }

    function showLeaderboard() {
      resultScreen.classList.add("hidden");
      leaderboardScreen.classList.remove("hidden");
      leaderboardTable.innerHTML = "<tr><th>Háº¡ng</th><th>TÃªn</th><th>Äiá»ƒm</th></tr>";
      const data = JSON.parse(localStorage.getItem("compost_leaderboard") || "[]");
      data.slice(0, 10).forEach((p, i) => {
        const row = `<tr><td>${i + 1}</td><td>${p.name}</td><td>${p.score}</td></tr>`;
        leaderboardTable.innerHTML += row;
      });
    }

    // HÃ m trá»™n cÃ¢u há»i ngáº«u nhiÃªn
    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
  </script>
</body>
</html>
